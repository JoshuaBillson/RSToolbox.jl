<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Spectral Analysis · RemoteSensingToolbox.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://JoshuaBillson.github.io/RemoteSensingToolbox.jl/spectral_example/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">RemoteSensingToolbox.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../quickstart/">Quick Start</a></li><li><a class="tocitem" href="../pca_example/">Principal Component Analysis</a></li><li class="is-active"><a class="tocitem" href>Spectral Analysis</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Spectral Analysis</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Spectral Analysis</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JoshuaBillson/RemoteSensingToolbox.jl/blob/main/docs/src/spectral_example.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Spectral-Analysis"><a class="docs-heading-anchor" href="#Spectral-Analysis">Spectral Analysis</a><a id="Spectral-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Spectral-Analysis" title="Permalink"></a></h1><p>A common application of remotely sensed imagery is land cover classification. One method to accomplish this is to analyze the spectral signatures produced by different types of cover. <code>RemoteSensingToolbox</code> provides a number of functions for extracting and visualyzing spectral signatures organized by their associated lan cover.</p><p>The first step in our analysis is to load our remotely sensed data and convert the DNs (Digital Numbers) to reflectances. Reflectance is a standardized unit of measurement defined over the interval [0, 1] which denotes the fraction of light that is reflected by the observed surface. A reflectance of 0.0 indicates that no light was reflected whereas a reflectance of 1.0 indicates that 100% of light was reflected.</p><pre><code class="language-julia hljs">using RemoteSensingToolbox, DataFrames, Shapefile, CairoMakie
using Pipe: @pipe

landsat = @pipe Landsat8(&quot;data/LC08_L2SP_043024_20200802_20200914_02_T1/&quot;) |&gt; dn_to_reflectance(Landsat8, _)</code></pre><p>Next, we need to load a shapefile which defines some regions containing each type of land cover that we&#39;re interested in.</p><pre><code class="language-julia hljs">shp = Shapefile.Table(&quot;data/landcover/landcover.shp&quot;) |&gt; DataFrame</code></pre><p>Examining the shapefile gives us some idea of how its contents are structured. As we can see, the regions of interest are stored as <code>Polygon</code> objects under the <code>:geometry</code> column, while the land cover types are under <code>:MC_name</code> and <code>:C_name</code>. The <code>:MC_name</code> column defines the macroclass, which in our case are built up land, vegetation, bare earth, and water. The <code>:C_name</code> column defines the specific class to which some land cover belongs. For example, both &quot;Trees&quot; and &quot;Vegetation&quot; belong to the &quot;Vegetation&quot; macroclass.</p><pre><code class="nohighlight hljs">8×7 DataFrame
 Row │ geometry            fid      MC_ID  MC_name     C_ID   C_name      SCP_UID                   
     │ Polygon             Missing  Int64  String      Int64  String      String                    
─────┼──────────────────────────────────────────────────────────────────────────────────────────────
   1 │ Polygon(38 Points)  missing      1  Built Up        1  Built Up    20230527_122212594060_314
   2 │ Polygon(31 Points)  missing      1  Built Up        2  Road        20230527_122301732906_304
   3 │ Polygon(7 Points)   missing      2  Vegetation      3  Vegetation  20230527_122832068862_302
   4 │ Polygon(57 Points)  missing      2  Vegetation      4  Trees       20230527_123221462871_572
   5 │ Polygon(5 Points)   missing      3  Bare Earth      5  Hail Scar   20230527_123631491671_937
   6 │ Polygon(7 Points)   missing      3  Bare Earth      6  Bare Earth  20230527_123727873290_779
   7 │ Polygon(7 Points)   missing      4  Water           7  Lake        20230527_123931189139_867
   8 │ Polygon(5 Points)   missing      3  Bare Earth      6  Bare Earth  20230527_125120033074_286</code></pre><p>We can extract the signatures inside each polygon with <code>extract_signatures</code>, then compute the average of each land cover class with <code>summarize_signatures</code>.</p><pre><code class="language-julia hljs">sigs = extract_signatures(landsat, shp, :C_name) |&gt; summarize_signatures</code></pre><pre><code class="nohighlight hljs">7×8 DataFrame
 Row │ label       B1           B2          B3         B4          B5        B6          B7         
     │ String      Float32      Float32     Float32    Float32     Float32   Float32     Float32    
─────┼──────────────────────────────────────────────────────────────────────────────────────────────
   1 │ Hail Scar   0.0617346    0.107954    0.188092   0.247114    0.508847  0.322815    0.173574
   2 │ Bare Earth  0.0483927    0.0539072   0.0773476  0.0883738   0.231219  0.307681    0.199805
   3 │ Road        0.0396956    0.0530674   0.0933762  0.0952315   0.245672  0.205506    0.142639
   4 │ Lake        0.000517442  0.00360272  0.0132789  0.00628491  0.031176  0.00697667  0.00377249
   5 │ Trees       0.0182846    0.0204864   0.0404257  0.0245542   0.319328  0.139772    0.0585171
   6 │ Vegetation  0.00442494   0.015797    0.0789011  0.0464686   0.49601   0.0964562   0.0407997
   7 │ Built Up    0.0892711    0.118764    0.177746   0.200785    0.293111  0.33917     0.304133</code></pre><p>Finally, we can visualize the signatures as a line graph with <code>plot_signatures</code>.</p><pre><code class="language-julia hljs">plot_signatures(Landsat8, sigs)</code></pre><p><img src="../figures/landsat_sigs_wong.png" alt/></p><p>We see that we&#39;ve plotted the signatures for each land cover type in <code>shp</code>. However, we may wish to override the default colors. Fortunately, <code>plot_signatures</code> accepts an optional argument allowing us to specify any colors that we wish.</p><pre><code class="language-julia hljs">plot_signatures(Landsat8, sigs; colors=cgrad(:tab10))</code></pre><p><img src="../figures/landsat_sigs_tab10.png" alt/></p><p>The <code>plot_signatures!</code> method is nearly identical to <code>plot_signatures</code>, but it expects a <code>Makie.Axis</code> object as its first argument onto which the signatures will be drawn (hence the exclamation). This allows us to create more complicated plots than are supported by <code>plot_signatures</code>. We will demonstrate this capability by plotting the same signatures for three different sensors, each of which passed over our study area within a period of four days. For this reason, we can compare the signatures with a single shapefile, as we do not expect the land cover types to change significantly within this span of time.</p><pre><code class="language-julia hljs"># Load Sentinel and DESIS
sentinel = @pipe read_bands(Sentinel2, &quot;data/T11UPT_20200804T183919/R60m/&quot;) |&gt; dn_to_reflectance(Sentinel2, _)
desis = @pipe read_bands(DESIS, &quot;data/DESIS-HSI-L2A-DT0884573241_001-20200601T234520-V0210&quot;) |&gt; dn_to_reflectance(DESIS, _)
sensors = [landsat, sentinel, desis]

# Create Figure
fig = Figure(resolution=(1000, 800))

# Create Axes
ax1 = Axis(fig[1,1], title=&quot;Landsat 8&quot;, xticksvisible=false, xticklabelsvisible=false)
ax2 = Axis(fig[2,1], title=&quot;Sentinel 2&quot;, ylabel=&quot;Reflectance&quot;, ylabelfont=:bold, xticksvisible=false, xticklabelsvisible=false)
ax3 = Axis(fig[3,1], title=&quot;DESIS&quot;, xlabel=&quot;Wavelength (nm)&quot;, xlabelfont=:bold)
axs = [ax1, ax2, ax3]

# Plot Signatures
colors = cgrad([:saddlebrown, :orange, :navy, :green], 4, categorical=true)
for (bandset, sensor, ax) in zip((Landsat8, Sentinel2, DESIS), sensors, axs)
   @pipe extract_signatures(sensor, shp, :MC_name) |&gt; summarize_signatures |&gt; plot_signatures!(ax, bandset, _; colors=colors)
   xlims!(ax, 400, 1000)
end

# Add Legend
Legend(fig[1:3,2], first(axs), &quot;Classification&quot;)</code></pre><p><img src="../figures/multisensor_sigs.png" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pca_example/">« Principal Component Analysis</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Friday 4 August 2023 21:54">Friday 4 August 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
