<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Spectral Analysis · RemoteSensingToolbox.jl</title><meta name="title" content="Spectral Analysis · RemoteSensingToolbox.jl"/><meta property="og:title" content="Spectral Analysis · RemoteSensingToolbox.jl"/><meta property="twitter:title" content="Spectral Analysis · RemoteSensingToolbox.jl"/><meta name="description" content="Documentation for RemoteSensingToolbox.jl."/><meta property="og:description" content="Documentation for RemoteSensingToolbox.jl."/><meta property="twitter:description" content="Documentation for RemoteSensingToolbox.jl."/><meta property="og:url" content="https://JoshuaBillson.github.io/RemoteSensingToolbox.jl/spectral_example/"/><meta property="twitter:url" content="https://JoshuaBillson.github.io/RemoteSensingToolbox.jl/spectral_example/"/><link rel="canonical" href="https://JoshuaBillson.github.io/RemoteSensingToolbox.jl/spectral_example/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">RemoteSensingToolbox.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../quickstart/">Quick Start</a></li><li><a class="tocitem" href="../pca_example/">Principal Component Analysis</a></li><li class="is-active"><a class="tocitem" href>Spectral Analysis</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Spectral Analysis</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Spectral Analysis</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JoshuaBillson/RemoteSensingToolbox.jl/blob/main/docs/src/spectral_example.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Spectral-Analysis"><a class="docs-heading-anchor" href="#Spectral-Analysis">Spectral Analysis</a><a id="Spectral-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Spectral-Analysis" title="Permalink"></a></h1><p>A common application of remotely sensed imagery is land cover classification. One method to accomplish this is to analyze the spectral signatures produced by different types of cover. <code>RemoteSensingToolbox</code> provides a number of functions for extracting and visualyzing spectral signatures organized by their associated lan cover.</p><p>The first step in our analysis is to load our remotely sensed data and convert the DNs (Digital Numbers) to reflectances. Reflectance is a standardized unit of measurement defined over the interval [0, 1] which denotes the fraction of light that is reflected by the observed surface. A reflectance of 0.0 indicates that no light was reflected whereas a reflectance of 1.0 indicates that 100% of light was reflected.</p><pre><code class="language-julia hljs">using RemoteSensingToolbox, DataFrames, Shapefile, CairoMakie
using Pipe: @pipe

landsat = @pipe read_bands(Landsat8, &quot;data/LC08_L2SP_043024_20200802_20200914_02_T1/&quot;) |&gt; dn_to_reflectance(Landsat8, _)</code></pre><p>Next, we need to load a shapefile which defines some regions containing each type of land cover that we&#39;re interested in.</p><pre><code class="language-julia hljs">shp = Shapefile.Table(&quot;data/landcover/landcover.shp&quot;) |&gt; DataFrame</code></pre><p>Examining the shapefile gives us some idea of how its contents are structured. As we can see, the regions of interest are stored as <code>Polygon</code> objects under the <code>:geometry</code> column, while the land cover types are under <code>:MC_name</code> and <code>:C_name</code>. The <code>:MC_name</code> column defines the macroclass, which in our case are built up land, vegetation, bare earth, and water. The <code>:C_name</code> column defines the specific class to which some land cover belongs. For example, both &quot;Trees&quot; and &quot;Vegetation&quot; belong to the &quot;Vegetation&quot; macroclass.</p><pre><code class="nohighlight hljs">8×7 DataFrame
 Row │ geometry            fid      MC_ID  MC_name     C_ID   C_name      SCP_UID                   
     │ Polygon             Missing  Int64  String      Int64  String      String                    
─────┼──────────────────────────────────────────────────────────────────────────────────────────────
   1 │ Polygon(38 Points)  missing      1  Built Up        1  Built Up    20230527_122212594060_314
   2 │ Polygon(31 Points)  missing      1  Built Up        2  Road        20230527_122301732906_304
   3 │ Polygon(7 Points)   missing      2  Vegetation      3  Vegetation  20230527_122832068862_302
   4 │ Polygon(57 Points)  missing      2  Vegetation      4  Trees       20230527_123221462871_572
   5 │ Polygon(5 Points)   missing      3  Bare Earth      5  Hail Scar   20230527_123631491671_937
   6 │ Polygon(7 Points)   missing      3  Bare Earth      6  Bare Earth  20230527_123727873290_779
   7 │ Polygon(7 Points)   missing      4  Water           7  Lake        20230527_123931189139_867
   8 │ Polygon(5 Points)   missing      3  Bare Earth      6  Bare Earth  20230527_125120033074_286</code></pre><p>We can extract the signatures inside each polygon with <code>extract_signatures</code>. This method returns a <code>RasterTable</code>, which is a special type optimized for extracting tablular data from a raster data source. Because <code>RasterTable</code> implements the <code>Tables.jl</code> interface, it can be directly sunk into other table constructors, such as  <code>DataFrames</code>, and is also compatible with external libraries like <code>TableOperations.jl</code>.</p><pre><code class="language-julia hljs">sigs = extract_signatures(landsat, shp, :C_name) |&gt; DataFrame</code></pre><pre><code class="nohighlight hljs">1925×8 DataFrame
  Row │ B1         B2         B3        B4        B5        B6        B7        label     
      │ Float32    Float32    Float32   Float32   Float32   Float32   Float32   String    
──────┼───────────────────────────────────────────────────────────────────────────────────
    1 │ 0.057235   0.10547    0.188932  0.24847   0.513405  0.315323  0.166107  Hail Scar
    2 │ 0.0574     0.105415   0.188712  0.24946   0.513735  0.317908  0.167593  Hail Scar
    3 │ 0.0584175  0.107175   0.19182   0.253887  0.515577  0.319585  0.168087  Hail Scar
    4 │ 0.0583625  0.10723    0.190995  0.253393  0.514615  0.317715  0.167097  Hail Scar
    5 │ 0.05806    0.10745    0.189895  0.250368  0.50774   0.315048  0.165475  Hail Scar
    6 │ 0.05553    0.102885   0.184175  0.243272  0.498417  0.307485  0.160938  Hail Scar
    7 │ 0.05267    0.0983475  0.176585  0.230073  0.48783   0.29159   0.153292  Hail Scar
  ⋮   │     ⋮          ⋮         ⋮         ⋮         ⋮         ⋮         ⋮          ⋮
 1919 │ 0.0320725  0.05993    0.11306   0.127415  0.272258  0.27322   0.220777  Built Up
 1920 │ 0.100575   0.127168   0.199218  0.23164   0.285677  0.323985  0.258645  Built Up
 1921 │ 0.077145   0.112097   0.17081   0.19677   0.25705   0.320877  0.28015   Built Up
 1922 │ 0.10712    0.136765   0.19666   0.225068  0.268655  0.33284   0.302288  Built Up
 1923 │ 0.0856425  0.123235   0.185853  0.211675  0.273     0.373623  0.351072  Built Up
 1924 │ 0.088145   0.119578   0.17059   0.204442  0.27487   0.355857  0.325553  Built Up
 1925 │ 0.0518725  0.0816275  0.148673  0.15189   0.28774   0.309218  0.29786   Built Up
                                                                         1911 rows omitted</code></pre><p>While <code>extract_signatures</code> can be a good first step for further statistical analysis or training classification modelsFinally, we are also often interested in visualizing the spectral signatures associated with each land cover type. To to do, we can call <code>plot_signatures</code>, which plots each signature as a <code>CairoMakie</code> line graph.</p><pre><code class="language-julia hljs">plot_signatures(Landsat8, landsat, shp, :C_name)</code></pre><p><img src="../figures/landsat_sigs_wong.png" alt/></p><p>We see that we&#39;ve plotted the signatures for each land cover type in <code>shp</code>. However, we may wish to override the default colors. Fortunately, <code>plot_signatures</code> accepts an optional argument allowing us to specify any colors that we wish.</p><pre><code class="language-julia hljs">plot_signatures(Landsat8, landsat, shp, :C_name; colors=cgrad(:tab10))</code></pre><p><img src="../figures/landsat_sigs_tab10.png" alt/></p><p>The <code>plot_signatures!</code> method is nearly identical to <code>plot_signatures</code>, but it expects a <code>Makie.Axis</code> object as its first argument onto which the signatures will be drawn (hence the exclamation). This allows us to create more sophisticated plots than are supported by <code>plot_signatures</code>. We will demonstrate this capability by plotting the same signatures for three different sensors, each of which passed over our study area within a period of four days. </p><pre><code class="language-julia hljs"># Load Sentinel and DESIS
sentinel = @pipe read_bands(Sentinel2, &quot;data/T11UPT_20200804T183919/R60m/&quot;) |&gt; dn_to_reflectance(Sentinel2, _)
desis = @pipe read_bands(DESIS, &quot;data/DESIS-HSI-L2A-DT0884573241_001-20200601T234520-V0210&quot;) |&gt; dn_to_reflectance(DESIS, _)
sensors = [landsat, sentinel, desis]

# Create Figure
fig = Figure(resolution=(1000, 800))

# Create Axes
ax1 = Axis(fig[1,1], title=&quot;Landsat 8&quot;, xticksvisible=false, xticklabelsvisible=false)
ax2 = Axis(fig[2,1], title=&quot;Sentinel 2&quot;, ylabel=&quot;Reflectance&quot;, ylabelfont=:bold, xticksvisible=false, xticklabelsvisible=false)
ax3 = Axis(fig[3,1], title=&quot;DESIS&quot;, xlabel=&quot;Wavelength (nm)&quot;, xlabelfont=:bold)
axs = [ax1, ax2, ax3]

# Plot Signatures
colors = cgrad([:saddlebrown, :navy, :orange, :green], 4, categorical=true)
for (bandset, sensor, ax) in zip((Landsat8, Sentinel2, DESIS), sensors, axs)
   plot_signatures!(ax, bandset, sensor, shp, :MC_name; colors=colors)
   xlims!(ax, 400, 1000)
end

# Add Legend
Legend(fig[1:3,2], first(axs), &quot;Classification&quot;)</code></pre><p><img src="../figures/multisensor_sigs.png" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pca_example/">« Principal Component Analysis</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Monday 1 January 2024 10:21">Monday 1 January 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
